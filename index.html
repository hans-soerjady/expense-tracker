<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    <script>
      // declare variable
      const dataBase = [];
      class Expense {
        constructor(type, nominal, note, date) {
          this.id = Math.round(Math.random() * 99999);
          this.type = type;
          this.nominal = nominal;
          this.note = note;
          this.date = new Date(date);
        }
      }


      // declare function
      const addData = (newData) => {
        dataBase.push(newData);
      };
      
      const showIncome = () => {
        let output = dataBase.filter((value) => value.type == "income");
        console.log(output);
        return output
          .map((val, idx) => {
            return `${idx + 1}. Tipe data: ${val.type}, Nominal uang: ${
              val.nominal
            }, Tanggal: ${val.date.toDateString()}`;
          })
          .join("\n");
      };
      const showExpense = () => {
        let output = dataBase.filter((value) => value.type == "expense");
        console.log(output);
        return output
          .map((val, idx) => {
            return `${idx + 1}. Tipe data: ${val.type}, Nominal uang: ${
              val.nominal
            }, Tanggal: ${val.date.toDateString()}`;
          })
          .join("\n");
      };
            const showTotal = () => {
        let total = 0;
        for (let i = 0; i < dataBase.length; i++) {
          if (dataBase[i].type === "income") {
            total += dataBase[i].nominal;
          } else if (dataBase[i].type === "expense") {
            total -= dataBase[i].nominal;
          }
        }
        return total;
      };
      
            const showByDate = (data, startDate, endDate) => {
            startDate = new Date(startDate)
            endDate = new Date(endDate)
            let result = data.filter((value) => (value.date) > startDate && (value.date) < endDate)
            return result
        }
            const deleteData = (data, id) => {
            let index = data.findIndex((value) => value.id === id)
            data.splice(index, 1)
        }

      // MENU UTAMA
      let exit = false;
      while (!exit) {
        const mainMenu = prompt("MASUKKIN MENU YANG MAU DITUJU A B C D E");
        switch (mainMenu) {
          // feature add data
          case "A":
            let type = prompt("Masukan tipe data (Income/Expense)");
            let nominal = prompt("Masukan nominal");
            let note = prompt("Masukan Catatan");
            let date = prompt("Masukan tanggal data (format: yyyy-mm-dd)");
            let obj = new Expense(type, parseInt(nominal), note, date);
            addData(obj);
            alert(
              `Tipe data: ${obj.type}, Nominal uang: ${
                obj.nominal
              }, Tanggal: ${obj.date.toDateString()} Berhasil ditambahkan`
            );
            break;
          // feature show total expense and income
          case "B":
            let menuB = prompt(
              `Pilih Menu:\nA. Lihat Data Income\nB. Lihat Data Expense\nC. Lihat Total Pengeluaran`
            );
            switch (menuB) {
              case "A":
                alert(`${showIncome()}`);
                break;
              case "B":
                alert(`${showExpense()}`);
                break;
              case "C":
                alert(
                  `Total pengeluaranmu selama ini : \n${showTotal()}\n${
                    showTotal() < 0 ? "Ngirit Masbro" : ""
                  }`
                );
                break;

              default:
                alert("Pilihan yang diinputkan tidak ada");
                break;
            }
            break;
            // feature show data based on 2 dates
            case "C":
                let startDate = prompt("Masukkan tanggal mulai nya:")
                let endDate = prompt("Masukkan tanggal terakhir nya:")

                showByDate(dataBase, startDate, endDate)
            break;
          // feature delete data
            case "D":
                let deleteId = prompt("Masukkan Id pengeluaran / pemasukkan yang di hapus: ")

                deleteData(dataBase, deleteId)
                break;
          // feature exit menu
          case "E":
            exit = true;
            break;

          // jika tidak ada pilihan
          default:
            break;
        }
      }
    </script>
  </body>
</html>
